{% extends '_layout.html' %} 
{% load widget_tweaks %} 
{% load static %} 
{% block title %} Create Food {% endblock title %} 
{% block content %}

<div class="section">
  <div class="columns">
    <div class="column is-half is-offset-one-quarter">
      <div class="card">
        <form method="POST" class="new-form" id="new-form" enctype="multipart/form-data">
              {% csrf_token %}
          <header class="card-header">
            <p class="card-header-title">
                <label for="name" class="form-label" style="padding-right: 10px">Name</label>
                {{ form.name|add_class:"input is-small"|attr:"id:brandName"}}
            </p>
          </header>
          <div class="card-content">
            <div class="field">
              <div class="control">
                  <input class="input" type="text" id="foodSearch" placeholder="Barcode #">
              </div>
              <div class="control">
                <button type="button" class="button is-primary is-light" onclick='fetchFood().then(placeFood)'>Search</button>
              </div>
              
            </div>
            <table class="table">
              <thead>
                <tr>
                  <th>Nutrition Facts</th>
                  <th>Per serving</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th>Fat (g)</th>
                  <td>{{ form.fats|add_class:"input is-small"|attr:"id:tableFats"|attr:"onchange:combinedCalories()" }}</td>
                </tr>
                  <tr style="background-color: azure;">
                  <th>-Saturated fat (g)</th>
                  <td><p id="tableSatFats"></p></td>
                </tr>
                <tr>
                  <th>Carbohydrates (g)</th>
                  <td>{{ form.carbohydrate|add_class:"input is-small"|attr:"id:tableCarbs"|attr:"onchange:combinedCalories()" }}</td>
                </tr>
                <tr style="background-color: azure;">
                  <th>- Sugars (g)</th>
                  <td><p id="sugarsServing"></p></td>
                </tr>
                  <tr>
                  <th>Protein (g)</th>
                  <td>{{ form.protein|add_class:"input is-small"|attr:"id:tableProtein"|attr:"onchange:combinedCalories()" }}</td>
                </tr>
                <tr>
                  <th>Calories (kcal)</th>
                  <td >{{ form.calories|add_class:"input is-small"|attr:"id:calories" }}</td>
                </tr>
              </tbody>
            </table>
            <footer class="card-footer">
              <div class="field is-grouped" style="padding-top: 10px">
                <div class="control">
                  <button type="submit" class="button is-link">Save</button>
                </div>
                <div class="control" >
                  <button type="button" class="button is-primary is-light" onclick='combinedCalories()'>Update</button>
                </div>
                <div class="control">
                  <a class="button is-link is-light" href="{%url 'food:home' user.pk %}">Cancel</a>
                </div>
              </div>
            </footer>
            </div>
        </form>
      </div>
    </div>
 


<!-- <div class="column is-half">
        <div class="card">
          <div class="card-header">
            <div class="card-header-title">Search for food</div>
          </div>
          <div class="card-content">
            <input class="input" type="text" id="foodSearch" placeholder="Barcode #">

                <p>Showing information for:</p>
                <p><strong><span id="brandName"></span></strong></p>
                <table class="table">
                  <thead>
                    <tr>
                      <th>Nutrition Facts</th>
                      <th>Per serving</th>
                    </tr>
                  </thead>
                  <tbody>

                  <tr>
                    <th>Fat (g)</th>
                    <td><span id="fatsServing"></span></td>
                  </tr>
                    <tr style="background-color: azure;">
                    <th>-Saturated fat (g)</th>
                    <td><span id="satFatsServing"></span></td>
                  </tr>
                  <tr>
                    <th>Carbohydrates (g)</th>
                    <td><span id="carbsServing"></span></td>
                  </tr>
                  <tr style="background-color: azure;">
                    <th>- Sugars (g)</th>
                    <td><span id="sugarsServing"></span></td>
                  </tr>
                    <tr>
                    <th>Protein (g)</th>
                    <td><span id="proServing"></span></td>
                  </tr>
                  <tr>
                    <th>Calories (kcal)</th>
                    <td ><span id="calServing"></span></td>
                  </tr>
                  </tbody>
                  </table>

                  <footer class="card-footer">
                    <div class="field is-grouped" style="padding-top: 10px">
                    <div class="control" >
                    <button type="button" class="button is-link is-light" onClick='fetchFood().then(displayFood)'>Search</button>
                    </div>
                    <div class="control" >
                    <button type="button" class="button is-primary is-light" onClick='useFood()'>Use</button>
                    </div>
                    </div>
                    </footer>
            </div>

        </div>
  </div> -->
 </div>
</div>




{{ data|json_script:"favData" }}
<script type="text/javascript">
  const fav_data = JSON.parse(document.getElementById('favData').textContent); 
  console.log(fav_data);
</script>
<script>
  let l=0;
  l= fav_data.length;
  let i=0;
  let select=document.getElementById("select");
  for(i=0;i<l;i++)
  {
  var opt = document.createElement('option');
  opt.value = fav_data[i].name;
  opt.innerHTML = fav_data[i].name;
  select.appendChild(opt);
  }
</script>
<script src="{% static 'js/calories.js' %}"></script>
<script src="{% static 'js/fetchFood.js' %}"></script>
{% endblock content %}